<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DraftEngine</title>
    <link rel="stylesheet" href="./app/styles.css" />
  </head>
  <body>
    <div class="bg-shape bg-shape-a"></div>
    <div class="bg-shape bg-shape-b"></div>
    <main class="layout">
      <header class="hero">
        <p id="hero-kicker" class="kicker">DraftEngine</p>
        <h1 id="hero-title">Build a Composition</h1>
        <p id="hero-subtitle" class="subtitle">
          Configure team context, shape compositions, and inspect deterministic next-pick trees.
        </p>
        <div class="hero-actions">
          <div class="auth-bar">
            <label id="auth-email-group">
              Email
              <input id="auth-email" type="email" autocomplete="username" placeholder="you@example.com" />
            </label>
            <label id="auth-game-name-group">
              Game Name
              <input id="auth-game-name" type="text" placeholder="Summoner name" />
            </label>
            <label id="auth-tagline-group">
              Tagline
              <input id="auth-tagline" type="text" placeholder="NA1" />
            </label>
            <label id="auth-password-group">
              Password
              <input id="auth-password" type="password" autocomplete="current-password" placeholder="password" />
            </label>
            <button id="auth-register" type="button">Register</button>
            <button id="auth-login" type="button">Login</button>
            <button id="auth-logout" class="ghost" type="button">Logout</button>
          </div>
          <button
            id="nav-toggle"
            class="ghost nav-toggle"
            type="button"
            aria-controls="nav-drawer"
            aria-expanded="false"
          >
            Menu
          </button>
        </div>
        <p id="auth-status" class="meta">Signed out.</p>
        <p id="auth-registration-help" class="meta">Registration requires Email, Game Name, Tagline, and Password.</p>
        <p id="auth-feedback" class="error-inline" hidden></p>
      </header>

      <section id="auth-gate" class="panel auth-gate">
        <p class="panel-kicker">Access Required</p>
        <h2>Login or Register</h2>
        <p class="meta">Sign in to access Workflow, Team Context, Profile, and Champion Tags.</p>
      </section>

      <div id="app-shell" class="app-shell" hidden>
        <aside id="nav-drawer" class="nav-drawer" aria-label="Primary">
          <nav class="panel side-menu">
            <h2 id="nav-title">Navigation</h2>
            <p id="nav-meta" class="meta">Switch between workflow and configuration pages.</p>
            <button class="side-menu-link is-active" data-tab="workflow" type="button">Workflow</button>
            <button class="side-menu-link" data-tab="team-config" type="button">Team Context</button>
            <button class="side-menu-link" data-tab="player-config" type="button">Profile</button>
            <button class="side-menu-link" data-tab="explorer" type="button">Champion Tags</button>
          </nav>
        </aside>
        <button id="nav-overlay" class="nav-overlay" type="button" aria-label="Close navigation"></button>

        <div class="main-content">
          <section id="tab-explorer" class="tab-panel tab-surface">
            <div class="panel draft-board-panel">
              <p class="panel-kicker">Champion Tags</p>
              <h2 id="explorer-title">Champion Tags</h2>
              <p id="explorer-meta" class="meta">Browse champions and filter by role, damage profile, scaling, and tags.</p>
            </div>
            <div class="panel draft-board-panel">
              <p class="panel-kicker">Filter Stack</p>
              <h2>Draft Filters</h2>
              <p class="meta">Narrow the candidate board with role, damage, scaling, and tag filters.</p>
              <div class="button-row explorer-toolbar">
                <button id="explorer-clear-all" class="ghost" type="button">Clear All Filters</button>
              </div>
              <div class="explorer-filters-grid">
                <label>
                  Search
                  <input id="explorer-search" type="search" placeholder="Champion name" />
                </label>
                <label>
                  Roles
                  <div id="explorer-role"></div>
                </label>
                <label>
                  Damage Type
                  <div id="explorer-damage"></div>
                </label>
                <label>
                  Scaling
                  <select id="explorer-scaling"></select>
                </label>
                <label>
                  Sort Cards
                  <select id="explorer-sort"></select>
                </label>
                <label>
                  Include Tags
                  <div id="explorer-include-tags"></div>
                </label>
                <label>
                  Exclude Tags
                  <div id="explorer-exclude-tags"></div>
                </label>
                <div class="explorer-tag-actions">
                  <button id="explorer-clear-include" class="ghost" type="button">Clear Include Tags</button>
                  <button id="explorer-clear-exclude" class="ghost" type="button">Clear Exclude Tags</button>
                </div>
              </div>
              <p class="meta">Include and Exclude tags are mutually exclusive. Selecting one removes it from the other.</p>
            </div>
            <div class="panel draft-board-panel">
              <p class="panel-kicker">Draft Board</p>
              <h2>Candidate Board</h2>
              <p id="explorer-count" class="meta"></p>
              <div id="explorer-results" class="card-grid"></div>
            </div>
          </section>

          <section id="tab-workflow" class="tab-panel tab-surface workflow-surface is-active">
            <section id="builder-stage-guide" class="panel draft-board-panel stage-guide" aria-live="polite">
              <p class="panel-kicker">Command Center</p>
              <h2 id="builder-workflow-title">Draft Workflow</h2>
              <p id="builder-stage-guide-meta" class="meta"></p>
              <div class="button-row stage-guide-actions">
                <button id="builder-continue-validate" type="button">Review Composition</button>
                <button id="builder-clear" type="button" class="ghost">Clear Composition</button>
              </div>
            </section>
            <div class="builder-grid">
              <aside id="builder-stage-setup" class="panel draft-board-panel stage-panel">
                <p class="panel-kicker">Setup Stage</p>
                <h2 id="builder-stage-setup-title">Setup</h2>
                <p id="builder-stage-setup-meta" class="meta">Set team context, lock known picks, and adjust generation constraints.</p>
                <div class="stack">
                  <label>
                    Active Team
                    <select id="builder-active-team"></select>
                  </label>
                  <p id="builder-team-help" class="meta"></p>
                  <div class="setup-board-grid">
                    <section class="slot-inputs-block">
                      <h3>Player Slots</h3>
                      <div class="slot-list">
                        <label class="slot-row" id="slot-row-Top" data-slot="Top">
                          <div class="slot-row-head">
                            <span id="slot-order-Top" class="slot-order">#1</span>
                            <span id="slot-label-Top">Top</span>
                            <span id="slot-status-Top" class="slot-status">Pending</span>
                          </div>
                          <select id="slot-Top"></select>
                        </label>
                        <label class="slot-row" id="slot-row-Jungle" data-slot="Jungle">
                          <div class="slot-row-head">
                            <span id="slot-order-Jungle" class="slot-order">#2</span>
                            <span id="slot-label-Jungle">Jungle</span>
                            <span id="slot-status-Jungle" class="slot-status">Pending</span>
                          </div>
                          <select id="slot-Jungle"></select>
                        </label>
                        <label class="slot-row" id="slot-row-Mid" data-slot="Mid">
                          <div class="slot-row-head">
                            <span id="slot-order-Mid" class="slot-order">#3</span>
                            <span id="slot-label-Mid">Mid</span>
                            <span id="slot-status-Mid" class="slot-status">Pending</span>
                          </div>
                          <select id="slot-Mid"></select>
                        </label>
                        <label class="slot-row" id="slot-row-ADC" data-slot="ADC">
                          <div class="slot-row-head">
                            <span id="slot-order-ADC" class="slot-order">#4</span>
                            <span id="slot-label-ADC">ADC</span>
                            <span id="slot-status-ADC" class="slot-status">Pending</span>
                          </div>
                          <select id="slot-ADC"></select>
                        </label>
                        <label class="slot-row" id="slot-row-Support" data-slot="Support">
                          <div class="slot-row-head">
                            <span id="slot-order-Support" class="slot-order">#5</span>
                            <span id="slot-label-Support">Support</span>
                            <span id="slot-status-Support" class="slot-status">Pending</span>
                          </div>
                          <select id="slot-Support"></select>
                        </label>
                      </div>
                    </section>
                    <div class="draft-order-block">
                      <h3>Node Draft Order</h3>
                      <p class="meta">Drag roles to reorder priority. Generation always fills the first unfilled role in this order.</p>
                      <p id="builder-next-role-readout" class="meta"></p>
                      <ul id="builder-draft-order" class="draft-order-list"></ul>
                    </div>
                  </div>
                  <p id="builder-setup-feedback" class="error-inline" hidden></p>
                  <details id="builder-advanced-controls" class="advanced-controls">
                    <summary>Advanced Controls</summary>
                    <div class="stack advanced-controls-content">
                      <fieldset id="builder-toggles" class="toggle-group">
                        <legend>Required Toggles</legend>
                      </fieldset>
                      <label>
                        Excluded Champions
                        <input id="builder-excluded-search" type="search" placeholder="Filter champion list" />
                      </label>
                      <div id="builder-excluded-options" class="excluded-options"></div>
                      <p class="meta">Multi-select checklist. Excluded champions are never offered in selectors or generated tree nodes.</p>
                      <div id="builder-excluded-pills" class="chip-row"></div>
                      <div class="grid grid-2">
                        <label>
                          Auto Depth (remaining slots)
                          <input id="builder-max-depth" type="number" min="0" max="5" step="1" readonly />
                        </label>
                        <label>
                          maxBranch
                          <input id="builder-max-branch" type="number" min="1" max="25" step="1" />
                        </label>
                      </div>
                    </div>
                  </details>
                </div>
              </aside>

              <section id="builder-stage-inspect" class="panel draft-board-panel stage-panel">
                <p class="panel-kicker">Review Stage</p>
                <h2 id="builder-stage-inspect-title">Review</h2>
                <p id="builder-stage-inspect-meta" class="meta">Review checks, generate options, and inspect slot-level node impact.</p>
                <p id="builder-checks-readiness" class="meta"></p>
                <div id="builder-team-context" class="team-context"></div>
                <div class="inspect-overview-grid">
                  <section class="inspect-column">
                    <h3>Required Checks</h3>
                    <ul id="builder-required-checks" class="check-list"></ul>
                    <div class="optional-checks-header">
                      <h3>Optional Checks</h3>
                      <button id="builder-toggle-optional-checks" class="ghost" type="button">Show Optional Checks</button>
                    </div>
                    <ul id="builder-optional-checks" class="check-list" hidden></ul>
                  </section>
                </div>
                <p id="builder-inspect-feedback" class="error-inline" hidden></p>
                <div class="button-row inspect-generate-row">
                  <button id="builder-generate" type="button">Generate Tree</button>
                  <p class="meta inspect-generate-help">Generates summary, tree map, and node outline below.</p>
                </div>
                <div class="tree-toolbar">
                  <label>
                    Density
                    <select id="tree-density">
                      <option value="summary">Summary</option>
                      <option value="detailed">Detailed</option>
                    </select>
                  </label>
                  <label>
                    Search Node
                    <input id="tree-search" type="search" placeholder="Champion, role, or slot value" />
                  </label>
                  <label>
                    Min Score
                    <input id="tree-min-score" type="number" step="1" min="0" value="0" />
                  </label>
                  <label>
                    Min Candidate Score
                    <input id="tree-min-candidate-score" type="number" step="1" min="0" value="1" />
                  </label>
                  <label class="inline-checkbox">
                    <input id="tree-valid-leaves-only" type="checkbox" checked />
                    Valid leaves only
                  </label>
                </div>
                <div class="button-row">
                  <button id="tree-expand-all" type="button" class="ghost">Expand All</button>
                  <button id="tree-collapse-all" type="button" class="ghost">Collapse All</button>
                </div>
                <div id="builder-tree-summary" class="tree-summary"></div>
                <div class="panel tree-map-panel">
                  <h3>Tree Map</h3>
                  <p class="meta">Graph view of expansion depth. Click any node marker to inspect it.</p>
                  <p id="tree-map-legend" class="meta">
                    Legend: terminal valid, recoverable, and filtered-context states.
                  </p>
                  <svg id="builder-tree-map" class="tree-map" viewBox="0 0 900 320" preserveAspectRatio="xMidYMid meet"></svg>
                </div>
                <div id="builder-tree" class="tree"></div>
              </section>
            </div>
          </section>

          <section id="tab-team-config" class="tab-panel tab-surface">
            <div class="panel draft-board-panel">
              <p class="panel-kicker">Team Setup</p>
              <h2 id="team-config-title">Team Context</h2>
              <p id="team-config-meta" class="meta">Set default and active team context for composition workflow.</p>
              <div class="team-context-controls">
                <label>
                  Default Team
                  <select id="team-config-default-team"></select>
                </label>
                <label>
                  Active Team
                  <select id="team-config-active-team"></select>
                </label>
              </div>
              <p id="team-config-default-help" class="meta"></p>
              <p id="team-config-active-help" class="meta"></p>
            </div>
            <div class="panel draft-board-panel">
              <p class="panel-kicker">Team Admin</p>
              <h2>Team Management</h2>
              <p class="meta">Team admin actions are lead-gated. Members can read membership only.</p>
              <div class="grid grid-2">
                <label>
                  Create Team
                  <input id="team-admin-create-name" type="text" placeholder="Team name" />
                </label>
                <div class="button-row">
                  <button id="team-admin-create" type="button">Create Team</button>
                </div>
              </div>
              <label>
                Team
                <select id="team-admin-team-select"></select>
              </label>
              <div class="grid grid-2">
                <label>
                  Rename Team
                  <input id="team-admin-rename-name" type="text" placeholder="New team name" />
                </label>
                <div class="button-row">
                  <button id="team-admin-rename" type="button">Rename Team</button>
                  <button id="team-admin-delete" class="ghost" type="button">Delete Team</button>
                </div>
              </div>
              <h3>Members</h3>
              <div id="team-admin-members" class="team-pool-grid"></div>
              <div class="grid grid-2">
                <label>
                  Add Member User ID
                  <input id="team-admin-add-user-id" type="number" min="1" step="1" placeholder="User ID" />
                </label>
                <label>
                  Add Member Role
                  <select id="team-admin-add-role">
                    <option value="member">member</option>
                    <option value="lead">lead</option>
                  </select>
                </label>
              </div>
              <label>
                Add Member Team Role
                <select id="team-admin-add-team-role">
                  <option value="substitute">substitute</option>
                  <option value="primary">primary</option>
                </select>
              </label>
              <div class="button-row">
                <button id="team-admin-add-member" type="button">Add Member</button>
              </div>
              <div class="grid grid-2">
                <label>
                  Update Role User ID
                  <input id="team-admin-role-user-id" type="number" min="1" step="1" placeholder="User ID" />
                </label>
                <label>
                  New Role
                  <select id="team-admin-role">
                    <option value="member">member</option>
                    <option value="lead">lead</option>
                  </select>
                </label>
              </div>
              <div class="button-row">
                <button id="team-admin-update-role" type="button">Update Role</button>
              </div>
              <div class="grid grid-2">
                <label>
                  Update Team Role User ID
                  <input id="team-admin-team-role-user-id" type="number" min="1" step="1" placeholder="User ID" />
                </label>
                <label>
                  New Team Role
                  <select id="team-admin-team-role">
                    <option value="substitute">substitute</option>
                    <option value="primary">primary</option>
                  </select>
                </label>
              </div>
              <div class="button-row">
                <button id="team-admin-update-team-role" type="button">Update Team Role</button>
              </div>
              <label>
                Remove Member User ID
                <input id="team-admin-remove-user-id" type="number" min="1" step="1" placeholder="User ID" />
              </label>
              <div class="button-row">
                <button id="team-admin-remove-member" class="ghost" type="button">Remove Member</button>
              </div>
              <p id="team-admin-feedback" class="meta"></p>
            </div>
            <div class="panel draft-board-panel">
              <p class="panel-kicker">Pool Intelligence</p>
              <h2>Draft Pool Board</h2>
              <p id="team-config-pool-summary" class="meta"></p>
              <div id="team-config-pool-grid" class="team-pool-grid"></div>
            </div>
          </section>

          <section id="tab-player-config" class="tab-panel tab-surface">
            <div class="panel draft-board-panel">
              <p class="panel-kicker">Profile</p>
              <h2 id="player-config-title">My Profile</h2>
              <p id="player-config-meta" class="meta">Manage your roles, champion pools, and teams.</p>
              <div class="profile-section">
                <p class="panel-kicker">My Roles</p>
                <div class="grid grid-2">
                  <label>
                    Role (primary)
                    <select id="profile-primary-role"></select>
                  </label>
                  <label>
                    Roles (other)
                    <div id="profile-secondary-roles"></div>
                  </label>
                </div>
                <div class="button-row">
                  <button id="profile-save-roles" type="button">Save Roles</button>
                </div>
                <p id="profile-roles-feedback" class="meta"></p>
              </div>
              <div class="profile-section">
                <p class="panel-kicker">My Champions</p>
                <div class="grid grid-2">
                  <label>
                    Role Pool
                    <select id="player-config-team"></select>
                  </label>
                  <p id="player-config-summary" class="meta"></p>
                </div>
                <p id="player-config-feedback" class="meta"></p>
                <div id="player-config-grid" class="player-pools-grid"></div>
              </div>
              <div class="settings-team-section">
                <p class="panel-kicker">My Teams</p>
                <div class="grid grid-2">
                  <div class="settings-team-column">
                    <h3>Teams You Are On</h3>
                    <p id="settings-teams-member-summary" class="meta"></p>
                    <div id="settings-teams-member-list" class="summary-card-list"></div>
                  </div>
                  <div class="settings-team-column">
                    <h3>Teams I Lead</h3>
                    <p id="settings-teams-lead-summary" class="meta"></p>
                    <div id="settings-teams-lead-list" class="summary-card-list"></div>
                  </div>
                </div>
                <div class="grid grid-2">
                  <label>
                    Create Team
                    <input id="settings-team-create-name" type="text" placeholder="Team name" />
                  </label>
                  <div class="button-row">
                    <button id="settings-team-create" type="button">Create Team</button>
                  </div>
                </div>
                <p id="settings-team-feedback" class="meta"></p>
              </div>
            </div>
          </section>
        </div>
      </div>
    </main>

    <script>
      window.DRAFTENGINE_API_BASE_URL =
        typeof window.DRAFTENGINE_API_BASE_URL === "string" && window.DRAFTENGINE_API_BASE_URL.trim() !== ""
          ? window.DRAFTENGINE_API_BASE_URL.trim()
          : "https://draftengine-0ee8.onrender.com";
    </script>
    <script type="module" src="./app/main.js"></script>
  </body>
</html>
